{% extends "core/base.html" %}

{% block page_title %}Ticket #{{ ticket.id }}{% endblock %}

{% block content %}
<div class="grid-container" style="grid-template-columns: 2fr 1fr;">
    <!-- Ticket Details -->
    <div class="widget-card">
        <h2 style="margin-top: 0; color: var(--accent-blue);">{{ ticket.title }}</h2>
        <p style="color: #888;">Reported by: {{ ticket.client }} on {{ ticket.created_at }}</p>

        <div style="margin: 20px 0; padding: 15px; background: rgba(0,0,0,0.2); border-radius: 8px;">
            {{ ticket.description|linebreaks }}
        </div>

        <h3>Messages</h3>
        {% for message in ticket.messages.all %}
        <div style="margin-bottom: 15px; padding: 10px; border-left: 2px solid {% if message.is_internal %}var(--accent-yellow){% else %}var(--accent-blue){% endif %}; background: rgba(255,255,255,0.02);">
            <div style="font-size: 0.8rem; color: #666; margin-bottom: 5px;">
                {{ message.author }} - {{ message.created_at }}
                {% if message.is_internal %}<span style="color: var(--accent-yellow); margin-left: 10px;">(Internal Note)</span>{% endif %}
            </div>
            {{ message.content|linebreaks }}
        </div>
        {% empty %}
        <p style="color: #666;">No messages yet.</p>
        {% endfor %}
    </div>

    <!-- Sidebar Info -->
    <div class="widget-card">
        <div class="form-group">
            <div class="widget-title">Status</div>
            <span class="status-badge status-{{ ticket.status }}">{{ ticket.get_status_display }}</span>
        </div>

        <div class="form-group">
            <div class="widget-title">Priority</div>
            <div style="font-size: 1.2rem;">{{ ticket.get_priority_display }}</div>
        </div>

        <div class="form-group">
            <div class="widget-title">Assigned To</div>
            <div>{{ ticket.assigned_to|default:"Unassigned" }}</div>
        </div>

        <div class="form-group">
            <div class="widget-title">Device</div>
            <div>{{ ticket.device|default:"None" }}</div>
        </div>
    </div>
</div>
{% endblock %}
